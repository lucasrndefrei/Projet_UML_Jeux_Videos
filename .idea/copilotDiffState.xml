<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/database_setup.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/database_setup.sql" />
              <option name="originalContent" value="-- Script SQL pour créer la base de données CapeTownGaming&#10;-- À exécuter dans MySQL Workbench&#10;&#10;-- Création de la base de données&#10;CREATE DATABASE IF NOT EXISTS CapeTownGaming&#10;CHARACTER SET utf8mb4&#10;COLLATE utf8mb4_unicode_ci;&#10;&#10;-- Utiliser la base de données&#10;USE CapeTownGaming;&#10;&#10;-- Table des clients&#10;CREATE TABLE IF NOT EXISTS customers (&#10;    id VARCHAR(36) PRIMARY KEY,&#10;    name VARCHAR(255) NOT NULL,&#10;    contact_number VARCHAR(50) NOT NULL UNIQUE,&#10;    password VARCHAR(255) NOT NULL DEFAULT '',&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;&#10;-- Table des jeux&#10;CREATE TABLE IF NOT EXISTS games (&#10;    id VARCHAR(36) PRIMARY KEY,&#10;    title VARCHAR(255) NOT NULL,&#10;    genre VARCHAR(100) NOT NULL,&#10;    platform ENUM('XBOX_ONE', 'XBOX_SERIES_X', 'XBOX_SERIES_S', 'PS4', 'PS5', 'PC_WINDOWS', 'PC_MAC', 'PC_LINUX') NOT NULL,&#10;    is_available BOOLEAN DEFAULT TRUE,&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;&#10;-- Table des locations&#10;CREATE TABLE IF NOT EXISTS rentals (&#10;    id VARCHAR(36) PRIMARY KEY,&#10;    customer_id VARCHAR(36) NOT NULL,&#10;    game_id VARCHAR(36) NOT NULL,&#10;    platform ENUM('XBOX_ONE', 'XBOX_SERIES_X', 'XBOX_SERIES_S', 'PS4', 'PS5', 'PC_WINDOWS', 'PC_MAC', 'PC_LINUX') NOT NULL,&#10;    rental_date DATE NOT NULL,&#10;    return_date DATE NOT NULL,&#10;    is_returned BOOLEAN DEFAULT FALSE,&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,&#10;    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,&#10;    FOREIGN KEY (game_id) REFERENCES games(id) ON DELETE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;&#10;-- Index pour améliorer les performances&#10;CREATE INDEX idx_customer_contact ON customers(contact_number);&#10;CREATE INDEX idx_game_platform ON games(platform, is_available);&#10;CREATE INDEX idx_rental_customer ON rentals(customer_id);&#10;CREATE INDEX idx_rental_game ON rentals(game_id);&#10;CREATE INDEX idx_rental_active ON rentals(is_returned);&#10;&#10;-- Insertion de quelques jeux de démonstration&#10;INSERT INTO games (id, title, genre, platform, is_available) VALUES&#10;('game-1', 'Halo Infinite', 'Shooter', 'XBOX_SERIES_X', TRUE),&#10;('game-2', 'Forza Horizon 5', 'Racing', 'XBOX_SERIES_X', TRUE),&#10;('game-3', 'God of War Ragnarök', 'Action', 'PS5', TRUE),&#10;('game-4', 'The Last of Us Part II', 'Action', 'PS4', TRUE),&#10;('game-5', 'Cyberpunk 2077', 'RPG', 'PC_WINDOWS', TRUE),&#10;('game-6', 'Elden Ring', 'RPG', 'PC_WINDOWS', TRUE),&#10;('game-7', 'Spider-Man Miles Morales', 'Action', 'PS5', TRUE),&#10;('game-8', 'Gears 5', 'Shooter', 'XBOX_ONE', TRUE);&#10;&#10;-- Vérification des tables créées&#10;SHOW TABLES;&#10;&#10;-- Affichage de la structure des tables&#10;DESCRIBE customers;&#10;DESCRIBE games;&#10;DESCRIBE rentals;&#10;&#10;" />
              <option name="updatedContent" value="-- Script SQL pour créer la base de données CapeTownGaming&#10;-- À exécuter dans MySQL Workbench&#10;&#10;-- Création de la base de données&#10;CREATE DATABASE IF NOT EXISTS CapeTownGaming&#10;CHARACTER SET utf8mb4&#10;COLLATE utf8mb4_unicode_ci;&#10;&#10;-- Utiliser la base de données&#10;USE CapeTownGaming;&#10;&#10;-- Table des clients&#10;CREATE TABLE IF NOT EXISTS customers (&#10;    id VARCHAR(36) PRIMARY KEY,&#10;    name VARCHAR(255) NOT NULL,&#10;    contact_number VARCHAR(50) NOT NULL UNIQUE,&#10;    password VARCHAR(255) NOT NULL DEFAULT '',&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;&#10;-- Table des jeux&#10;CREATE TABLE IF NOT EXISTS games (&#10;    id VARCHAR(36) PRIMARY KEY,&#10;    title VARCHAR(255) NOT NULL,&#10;    genre VARCHAR(100) NOT NULL,&#10;    platform ENUM('XBOX_ONE', 'XBOX_SERIES_X', 'XBOX_SERIES_S', 'PS4', 'PS5', 'PC_WINDOWS', 'PC_MAC', 'PC_LINUX') NOT NULL,&#10;    is_available BOOLEAN DEFAULT TRUE,&#10;    type ENUM('RENTAL', 'SALE') NOT NULL DEFAULT 'RENTAL',&#10;    price DECIMAL(8,2) NOT NULL DEFAULT 0.00,&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;&#10;-- Table des locations&#10;CREATE TABLE IF NOT EXISTS rentals (&#10;    id VARCHAR(36) PRIMARY KEY,&#10;    customer_id VARCHAR(36) NOT NULL,&#10;    game_id VARCHAR(36) NOT NULL,&#10;    platform ENUM('XBOX_ONE', 'XBOX_SERIES_X', 'XBOX_SERIES_S', 'PS4', 'PS5', 'PC_WINDOWS', 'PC_MAC', 'PC_LINUX') NOT NULL,&#10;    rental_date DATE NOT NULL,&#10;    return_date DATE NOT NULL,&#10;    is_returned BOOLEAN DEFAULT FALSE,&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,&#10;    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,&#10;    FOREIGN KEY (game_id) REFERENCES games(id) ON DELETE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;&#10;&#10;-- Index pour améliorer les performances&#10;CREATE INDEX idx_customer_contact ON customers(contact_number);&#10;CREATE INDEX idx_game_platform ON games(platform, is_available);&#10;CREATE INDEX idx_rental_customer ON rentals(customer_id);&#10;CREATE INDEX idx_rental_game ON rentals(game_id);&#10;CREATE INDEX idx_rental_active ON rentals(is_returned);&#10;&#10;-- Insertion de quelques jeux de démonstration&#10;INSERT INTO games (id, title, genre, platform, is_available, type, price) VALUES&#10;('game-1', 'Halo Infinite', 'Shooter', 'XBOX_SERIES_X', TRUE, 'RENTAL', 4.99),&#10;('game-2', 'Forza Horizon 5', 'Racing', 'XBOX_SERIES_X', TRUE, 'RENTAL', 3.99),&#10;('game-3', 'God of War Ragnarök', 'Action', 'PS5', TRUE, 'RENTAL', 5.99),&#10;('game-4', 'The Last of Us Part II', 'Action', 'PS4', TRUE, 'RENTAL', 3.49),&#10;('game-5', 'Cyberpunk 2077', 'RPG', 'PC_WINDOWS', TRUE, 'RENTAL', 4.49),&#10;('game-6', 'Elden Ring', 'RPG', 'PC_WINDOWS', TRUE, 'SALE', 49.99),&#10;('game-7', 'Spider-Man Miles Morales', 'Action', 'PS5', TRUE, 'SALE', 39.99),&#10;('game-8', 'Gears 5', 'Shooter', 'XBOX_ONE', TRUE, 'SALE', 29.99),&#10;('game-9', 'FIFA 25', 'Sport', 'PS5', TRUE, 'SALE', 59.99),&#10;('game-10', 'Call of Duty: Modern Warfare 3', 'Shooter', 'XBOX_SERIES_X', TRUE, 'SALE', 69.99),&#10;('game-11', 'The Sims 5', 'Simulation', 'PC_WINDOWS', TRUE, 'SALE', 44.99),&#10;('game-12', 'Gran Turismo 8', 'Racing', 'PS5', TRUE, 'SALE', 54.99),&#10;('game-13', 'Minecraft Legends', 'Adventure', 'PC_WINDOWS', TRUE, 'SALE', 24.99),&#10;('game-14', 'Forza Motorsport', 'Racing', 'XBOX_SERIES_X', TRUE, 'SALE', 49.99),&#10;('game-15', 'Football Manager 2025', 'Sport', 'PC_WINDOWS', TRUE, 'SALE', 39.99);&#10;&#10;-- Vérification des tables créées&#10;SHOW TABLES;&#10;&#10;-- Affichage de la structure des tables&#10;DESCRIBE customers;&#10;DESCRIBE games;&#10;DESCRIBE rentals;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/domain/Game.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/domain/Game.java" />
              <option name="originalContent" value="package fr.efrei.domain;&#10;&#10;&#10;import java.io.Serializable;&#10;import java.util.Objects;&#10;&#10;public class Game implements Serializable {&#10;    private final String id;&#10;    private final String title;&#10;    private final String genre;&#10;    private final GamePlatform platform;&#10;    private boolean available;&#10;&#10;    private Game(Builder builder) {&#10;        this.id = builder.id;&#10;        this.title = builder.title;&#10;        this.genre = builder.genre;&#10;        this.platform = builder.platform;&#10;        this.available = builder.available;&#10;    }&#10;&#10;    public String getId() { return id; }&#10;    public String getTitle() { return title; }&#10;    public String getGenre() { return genre; }&#10;    public GamePlatform getPlatform() { return platform; }&#10;    public boolean isAvailable() { return available; }&#10;&#10;    public void setAvailable(boolean available) { this.available = available; }&#10;&#10;    public static class Builder {&#10;        private String id;&#10;        private String title;&#10;        private String genre;&#10;        private GamePlatform platform;&#10;        private boolean available = true;&#10;&#10;        public Builder setId(String id) { this.id = id; return this; }&#10;        public Builder setTitle(String title) { this.title = title; return this; }&#10;        public Builder setGenre(String genre) { this.genre = genre; return this; }&#10;        public Builder setPlatform(GamePlatform platform) { this.platform = platform; return this; }&#10;        public Builder setAvailable(boolean available) { this.available = available; return this; }&#10;&#10;        public Game build() { return new Game(this); }&#10;    }&#10;&#10;    @Override&#10;    public boolean equals(Object o) {&#10;        if (this == o) return true;&#10;        if (!(o instanceof Game)) return false;&#10;        Game game = (Game) o;&#10;        return Objects.equals(id, game.id);&#10;    }&#10;&#10;    @Override&#10;    public int hashCode() { return Objects.hash(id); }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Game{&quot; +&#10;                &quot;id='&quot; + id + '\\' +&#10;                &quot;, title='&quot; + title + '\\' +&#10;                &quot;, genre='&quot; + genre + '\\' +&#10;                &quot;, platform=&quot; + platform +&#10;                &quot;, available=&quot; + available +&#10;                '}';&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package fr.efrei.domain;&#10;&#10;&#10;import java.io.Serializable;&#10;import java.util.Objects;&#10;&#10;public class Game implements Serializable {&#10;    private final String id;&#10;    private final String title;&#10;    private final String genre;&#10;    private final GamePlatform platform;&#10;    private final GameType type;&#10;    private boolean available;&#10;    private final double price;&#10;&#10;    private Game(Builder builder) {&#10;        this.id = builder.id;&#10;        this.title = builder.title;&#10;        this.genre = builder.genre;&#10;        this.platform = builder.platform;&#10;        this.available = builder.available;&#10;        this.type = builder.type;&#10;        this.price = builder.price;&#10;    }&#10;&#10;    public String getId() { return id; }&#10;    public String getTitle() { return title; }&#10;    public String getGenre() { return genre; }&#10;    public GamePlatform getPlatform() { return platform; }&#10;    public GameType getType() { return type; }&#10;    public boolean isAvailable() { return available; }&#10;    public double getPrice() { return price; }&#10;&#10;    public void setAvailable(boolean available) { this.available = available; }&#10;&#10;    public static class Builder {&#10;        private String id;&#10;        private String title;&#10;        private String genre;&#10;        private GamePlatform platform;&#10;        private boolean available = true;&#10;        private fr.efrei.domain.GameType type = fr.efrei.domain.GameType.RENTAL;&#10;        private double price = 0.0;&#10;&#10;        public Builder setId(String id) { this.id = id; return this; }&#10;        public Builder setTitle(String title) { this.title = title; return this; }&#10;        public Builder setGenre(String genre) { this.genre = genre; return this; }&#10;        public Builder setPlatform(GamePlatform platform) { this.platform = platform; return this; }&#10;        public Builder setAvailable(boolean available) { this.available = available; return this; }&#10;        public Builder setType(fr.efrei.domain.GameType type) { this.type = type; return this; }&#10;        public Builder setPrice(double price) { this.price = price; return this; }&#10;&#10;        public Game build() { return new Game(this); }&#10;    }&#10;&#10;    @Override&#10;    public boolean equals(Object o) {&#10;        if (this == o) return true;&#10;        if (!(o instanceof Game)) return false;&#10;        Game game = (Game) o;&#10;        return Objects.equals(id, game.id);&#10;    }&#10;&#10;    @Override&#10;    public int hashCode() { return Objects.hash(id); }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Game{&quot; +&#10;                &quot;id='&quot; + id + '\\' +&#10;                &quot;, title='&quot; + title + '\\' +&#10;                &quot;, genre='&quot; + genre + '\\' +&#10;                &quot;, platform=&quot; + platform +&#10;                &quot;, type=&quot; + type +&#10;                &quot;, available=&quot; + available +&#10;                &quot;, price=&quot; + price +&#10;                '}';&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/domain/GameType.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/domain/GameType.java" />
              <option name="updatedContent" value="package fr.efrei.domain;&#10;&#10;public enum GameType {&#10;    RENTAL,&#10;    SALE&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/factory/GameFactory.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/factory/GameFactory.java" />
              <option name="originalContent" value="package fr.efrei.factory;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.util.Helper;&#10;&#10;public final class GameFactory {&#10;    private GameFactory() {}&#10;&#10;    public static Game create(String id, String title, String genre) {&#10;        return create(id, title, genre, null);&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform) {&#10;        String finalId = (id == null || id.isBlank()) ? Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(true)&#10;                .build();&#10;    }&#10;&#10;    private static void validateNotBlank(String v, String field) {&#10;        if (v == null || v.isBlank())&#10;            throw new IllegalArgumentException(&quot;Invalid &quot; + field + &quot;: required&quot;);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package fr.efrei.factory;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.util.Helper;&#10;&#10;public final class GameFactory {&#10;    private GameFactory() {}&#10;&#10;    public static Game create(String id, String title, String genre) {&#10;        return create(id, title, genre, null);&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform) {&#10;        String finalId = (id == null || id.isBlank()) ? Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(true)&#10;                .build();&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform, boolean available, fr.efrei.domain.GameType type) {&#10;        String finalId = (id == null || id.isBlank()) ? fr.efrei.util.Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(available)&#10;                .setType(type)&#10;                .build();&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform, boolean available, fr.efrei.domain.GameType type, double price) {&#10;        String finalId = (id == null || id.isBlank()) ? fr.efrei.util.Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(available)&#10;                .setType(type)&#10;                .setPrice(price)&#10;                .build();&#10;    }&#10;&#10;    private static void validateNotBlank(String v, String field) {&#10;        if (v == null || v.isBlank())&#10;            throw new IllegalArgumentException(&quot;Invalid &quot; + field + &quot;: required&quot;);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/repository/GameRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/repository/GameRepository.java" />
              <option name="originalContent" value="package fr.efrei.repository;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.factory.GameFactory;&#10;import fr.efrei.util.DatabaseConnection;&#10;&#10;import java.sql.*;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class GameRepository {&#10;&#10;    private Connection getConnection() {&#10;        return DatabaseConnection.getInstance().getConnection();&#10;    }&#10;&#10;    public Game save(Game game) {&#10;        String sql = &quot;INSERT INTO games (id, title, genre, platform, is_available) VALUES (?, ?, ?, ?, ?) &quot; +&#10;                     &quot;ON DUPLICATE KEY UPDATE title = VALUES(title), genre = VALUES(genre), &quot; +&#10;                     &quot;platform = VALUES(platform), is_available = VALUES(is_available)&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, game.getId());&#10;            stmt.setString(2, game.getTitle());&#10;            stmt.setString(3, game.getGenre());&#10;            stmt.setString(4, game.getPlatform().name());&#10;            stmt.setBoolean(5, game.isAvailable());&#10;            stmt.executeUpdate();&#10;            return game;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la sauvegarde du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return null;&#10;        }&#10;    }&#10;&#10;    public Game findById(String id) {&#10;        String sql = &quot;SELECT * FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            ResultSet rs = stmt.executeQuery();&#10;&#10;            if (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;))&#10;                );&#10;                game.setAvailable(rs.getBoolean(&quot;is_available&quot;));&#10;                return game;&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la recherche du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return null;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAll() {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;))&#10;                );&#10;                game.setAvailable(rs.getBoolean(&quot;is_available&quot;));&#10;                games.add(game);&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAvailableByPlatform(GamePlatform platform) {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games WHERE is_available = true&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                GamePlatform gamePlatform = GamePlatform.valueOf(rs.getString(&quot;platform&quot;));&#10;                if (gamePlatform.isCompatibleWith(platform)) {&#10;                    Game game = GameFactory.create(&#10;                        rs.getString(&quot;id&quot;),&#10;                        rs.getString(&quot;title&quot;),&#10;                        rs.getString(&quot;genre&quot;),&#10;                        gamePlatform&#10;                    );&#10;                    game.setAvailable(rs.getBoolean(&quot;is_available&quot;));&#10;                    games.add(game);&#10;                }&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public boolean delete(String id) {&#10;        String sql = &quot;DELETE FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la suppression du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;&#10;    public boolean updateAvailability(String gameId, boolean available) {&#10;        String sql = &quot;UPDATE games SET is_available = ? WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setBoolean(1, available);&#10;            stmt.setString(2, gameId);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la mise à jour de la disponibilité : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package fr.efrei.repository;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.factory.GameFactory;&#10;import fr.efrei.util.DatabaseConnection;&#10;&#10;import java.sql.*;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class GameRepository {&#10;&#10;    private Connection getConnection() {&#10;        return DatabaseConnection.getInstance().getConnection();&#10;    }&#10;&#10;    public Game save(Game game) {&#10;        String sql = &quot;INSERT INTO games (id, title, genre, platform, is_available, type, price) VALUES (?, ?, ?, ?, ?, ?, ?) &quot; +&#10;                     &quot;ON DUPLICATE KEY UPDATE title = VALUES(title), genre = VALUES(genre), &quot; +&#10;                     &quot;platform = VALUES(platform), is_available = VALUES(is_available), type = VALUES(type), price = VALUES(price)&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, game.getId());&#10;            stmt.setString(2, game.getTitle());&#10;            stmt.setString(3, game.getGenre());&#10;            stmt.setString(4, game.getPlatform().name());&#10;            stmt.setBoolean(5, game.isAvailable());&#10;            stmt.setString(6, game.getType().name());&#10;            stmt.setDouble(7, game.getPrice());&#10;            stmt.executeUpdate();&#10;            return game;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la sauvegarde du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return null;&#10;        }&#10;    }&#10;&#10;    public Game findById(String id) {&#10;        String sql = &quot;SELECT * FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            ResultSet rs = stmt.executeQuery();&#10;&#10;            if (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;)),&#10;                    rs.getBoolean(&quot;is_available&quot;),&#10;                    fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                    rs.getDouble(&quot;price&quot;)&#10;                );&#10;                return game;&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la recherche du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return null;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAll() {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;)),&#10;                    rs.getBoolean(&quot;is_available&quot;),&#10;                    fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                    rs.getDouble(&quot;price&quot;)&#10;                );&#10;                games.add(game);&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAvailableByPlatform(GamePlatform platform) {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games WHERE is_available = true&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                GamePlatform gamePlatform = GamePlatform.valueOf(rs.getString(&quot;platform&quot;));&#10;                if (gamePlatform.isCompatibleWith(platform)) {&#10;                    Game game = GameFactory.create(&#10;                        rs.getString(&quot;id&quot;),&#10;                        rs.getString(&quot;title&quot;),&#10;                        rs.getString(&quot;genre&quot;),&#10;                        gamePlatform,&#10;                        rs.getBoolean(&quot;is_available&quot;),&#10;                        fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                        rs.getDouble(&quot;price&quot;)&#10;                    );&#10;                    games.add(game);&#10;                }&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAvailableForSaleByPlatform(GamePlatform platform) {&#10;        String sql = &quot;SELECT * FROM games WHERE platform = ? AND is_available = TRUE AND type = 'SALE'&quot;;&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, platform.name());&#10;            ResultSet rs = stmt.executeQuery();&#10;            while (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;)),&#10;                    rs.getBoolean(&quot;is_available&quot;),&#10;                    fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                    rs.getDouble(&quot;price&quot;)&#10;                );&#10;                games.add(game);&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux à vendre : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public boolean delete(String id) {&#10;        String sql = &quot;DELETE FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la suppression du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;&#10;    public boolean updateAvailability(String gameId, boolean available) {&#10;        String sql = &quot;UPDATE games SET is_available = ? WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setBoolean(1, available);&#10;            stmt.setString(2, gameId);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la mise à jour de la disponibilité : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>